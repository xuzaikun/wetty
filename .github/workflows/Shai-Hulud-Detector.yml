name: security-scan
on:
  push:
    branches:
      - main

jobs:
  test:
    runs-on: ubuntu-latest
    name: Run Shai-Hulud Detector
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Run Shai-Hulud Detector
        uses: gensecaihq/Shai-Hulud-2.0-Detector@v2
        with:
          fail-on-critical: true
          fail-on-high: false
          fail-on-any: false
          scan-lockfiles: true
          scan-node-modules: false
          output-format: text
          working-directory: '.'
